---
import fetchApi from '../../lib/payload';
import type FrontPage from '../../interfaces/frontPage';
import type { ExoveBlog } from '../../interfaces/blogInterfaces';
import type RichTextNode from '../../interfaces/RichText';
import Layout from '../../layouts/Layout.astro';
import ExoveBlogHighlights from '../../components/ExoveBlogHighlights.astro';
import RichText from '../../components/RichText';

const frontPage = await fetchApi<FrontPage>({
  endpoint: 'frontPage',
  global: true,
  lang: 'fi'
});

const posts = await fetchApi<ExoveBlog>({
  endpoint: 'blogCards',
  global: false,
  wrappedByKey: 'docs',
  lang: 'fi',
  sort: '-date'
});

const nodes = frontPage.content.root.children as RichTextNode[];
---

<Layout title={ frontPage.title } locale="en" metaDescription={ frontPage.metaDescription }
  currentType="front" currentUrl="front" fiUrl="front" engUrl="front" alternateFi="fi" alternateEn="en" type="front"
>
  <div class="max-w-[1564px] mx-auto md:px-8-px md:flex">
    <div class="text-lt-gray dark:text-dk-gray py-2 px-4-px max-w-xl mx-auto md:py-6 md:px-8-px lg:max-w-4xl">
      <h1 id="skip-target">{ frontPage.title }</h1>
      <div class="text-xl bodytext">
        <RichText client:load nodes={nodes} lang="en" />
      </div>
    </div>
  </div>
  <ExoveBlogHighlights slot="blogs"
    title="Uusimmat kirjoitukseni Exoven blogissa"
    intro="Yritän tehdä osuuteni Exoven tavoitteessa poistaa digiturhautumista kirjoittamalla saavutettavuudesta Exoven blogissa."
    posts={posts}
    bgClass="bg-gray"
  />
</Layout>
